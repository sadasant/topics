define("TopicsView",["jquery","underscore","backbone","text!../templates/topic.html"],function(e,t,n,r){var i,s={"click .del":"remove"},o,u,a,f;return i=n.View.extend({initialize:function(n){t(this).bindAll("add"),this.collection&&(u=this.collection,this.collection.bind("add",this.add),this.tags={},f=n.screen_name,a=e("#loading")),this.template=t.template(r)},render:function(){return e(this.el).html(this.template({topic:this.model.attributes,user:{screen_name:f}})),this},add:function(e){var t=new i({model:e}),n=this;t.delegateEvents(s),this.tags[e.attributes._id]=t,a.before(t.render().el),e.id=e.attributes._id,e.urlRoot="api/1/"+f+"/topic",e.bind("delete",function(t){n.collection.remove(e),e.destroy({success:function(){t()},error:function(e,t,r){n.$el.find(".load").addClass("error"),console.log("ERROR",t)}})})},renderAll:function(){var e=this;t.each(this.collection.models,function(t){e.add(t)})},remove:function(t){var n=this.el.id?this.$el:e(t.currentTarget.parentElement),r=n[0].id.slice(7),i=this.el.id?this.model:u.find(function(e){return e.attributes._id===r}),s=n.find(".del"),a=n.find(".load");o.render({text:'Remove "<b>'+i.attributes.name+"</b>\" and all it's notes?",yes:"Yes!",no:"Nope"},function(){s.hide(),a.removeClass("hide"),i.trigger("delete",function(){n.fadeOut(100,function(){n.remove()})})})}}),i.setConfirmView=function(e){o=e},i})